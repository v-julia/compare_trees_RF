write.csv(df1,"D:/Microbiome/16s_v4_ibs/ibs_species-counts.csv")
df1 = df[,1:761]
write.csv(df1,"D:/Microbiome/16s_v4_ibs/ibs_species-counts.csv")
write.csv(df1,"D:/Microbiome/16s_v4_ibs/ibs_species-counts.csv",row.names = FALSE)
apply(df1, sum, 1)
sapply(df1, sum)
sapply(df1, sum())
colSums(df1)
df = read.csv("D:/Microbiome/16s_v4_ibs/dada2_153_7_run2/taxonomy_oriented-barplots270-0.9/a3c70a21-8d14-4506-9c49-f2a687fc1835/data/level-7.csv",
header = TRUE)
df
View(df)
df1 = df[,1:761]
df1_num = df1[:,-1]
df1_num = df1[:,-1:]
df1_num = df1[,-1:]
df1_num = df1[,-1]
View(df1_num)
colSums(df1_num)
df1_num/colSums(df1_num)
df1_num_perc = df1_num/colSums(df1_num)
View(df1_num_perc)
df1_num_perccolsums = colSums(df1_num_perc)
library(dplyr)
library(tidyr)
df1_num  %>%
mutate(percent = n/sum(n))
prop.table(df1_num)
df1_num_perc = prop.table(df1_num)
df1_num_perccolsums = colSums(df1_num_perc)
df1_num_perccolsums
prop.table
prop.table
df1_num_perc = prop.table(df1_num, 2)
df1_num_perccolsums = colSums(df1_num_perc)
View(df1_num_perc)
df1_num_perc = prop.table(df1_num, 1)
df1_num_perccolsums = colSums(df1_num_perc)
df1_num_perc = prop.table(df1_num, 1)
df1_num
m = as.matrix(df1_num_perc)
View(m)
df = read.csv("D:/Microbiome/16s_v4_ibs/dada2_153_7_run2/taxonomy_oriented-barplots270-0.9/a3c70a21-8d14-4506-9c49-f2a687fc1835/data/level-7.csv",
header = TRUE)
df1 = df[,1:761]
df1_num = df1[,-1]
m = as.matrix(df1_num)
m = as.matrix(df1_num)
df1_num_perc = prop.table(df1_num, 1)
df1_num_perc = prop.table(m, 1)
df1_num_perccolsums = colSums(df1_num_perc)
df1_num_perccolsums = rowSums(df1_num_perc)
df1_num_perc = prop.table(m, 2)
df1_num_perccolsums = rowSums(df1_num_perc)
df1_num_perccolsums = colSums(df1_num_perc)
m_perc = prop.table(m, 2)
as.dataframe(m_perc)
df1_percent = as.data.frame(m_perc)
View(df1_percent)
df1[,1]
df1_percent = cbind(df1[,1],as.data.frame(m_perc))
View(df1_percent)
colSums(df1_percent[,-1])
write.csv(df1_percent,"D:/Microbiome/16s_v4_ibs/ibs_species-percents.csv",row.names = FALSE)
m_perc = prop.table(m, 1)
df1_percent = cbind(df1[,1],as.data.frame(m_perc))
write.csv(df1_percent,"D:/Microbiome/16s_v4_ibs/ibs_species-percents.csv",row.names = FALSE)
rowSums(df1_percent)
rowSums(m_perc)
df1_percent = cbind(df1[,1],as.data.frame(m_perc))
write.csv(df1_percent,"D:/Microbiome/16s_v4_ibs/ibs_species-percents.csv",row.names = FALSE)
rowSums(m_perc)
library('ape')
library('cowplot')
library('ggplot2')
library('ggtree')
library('ggnewscale')
library('phytools')
library('treeio')
library('EBImage')
library('GiNA')
library(randomcoloR)
library(viridis)
library(paletteer)
library("seqinr")
library(stringr)
library(spaa)
library(ggExtra)
library(patchwork)
library(dplyr)
install.packages("dplyr")
setwd("D:/Virology/RNA_viruses/Compare_trees")
library(ggtree)
library(treeio)
tree1_name = "norovirus_rdrp_g2_yearonly_colnodes.tree"
tree1 = read.beast(tree1_name)
library(ape) # for phylo objects
tree1@phylo
tree1@phylo$tip.label
tree1@phylo$Nnode
tree1@tipseq_file
tree1@data
child(tree1,2)
child(tree1@data,2)
library(tidyr)
tree1 %>% as.tibble
tree1 %>% as_tibble
child(tree1 %>% as_tibble,2)
child(tree1 %>% as_tibble,10)
child(tree1 %>% as_tibble,1)
child(tree1 %>% as_tibble,25)
child(tree1 %>% as_tibble,925)
offspring(tree1 %>% as_tibble,925)
tree1@phylo
grp <- list(same = tree1@phylo$tip.label[1:50])
grp[[1]]
groupOTU(p, grp, 'Species') + aes(color=Species) +
theme(legend.position="right")
p <- ggtree(tree2, aes(color=group)) + theme(legend.position='none') +
scale_color_manual(values=c("black", "firebrick"))
p <- ggtree(tree1, aes(color=group)) + theme(legend.position='none') +
scale_color_manual(values=c("black", "firebrick"))
p
p <- ggtree(tree1, layout = 'circular', branch.length='none')
groupOTU(p, grp, 'Species') + aes(color=Species) +
theme(legend.position="right")
groupOTU(p, grp, 'Species') + aes(color=Species) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
grp <- list(same = tree1@phylo$tip.label[1:2],
same = tree1@phylo$tip.label[5:10])
groupOTU(p, grp, 'Species') + aes(color=Species) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
grp <- list(same = c("KM198549_VNM_human_2010_GII.6_GII.P7","KM198531_VNM_human_2009_GII.6_GII.P7"),
same = c("MF140680_NLD_human_2014_GII.6_GII.P7","MF140679_NLD_human_2014_GII.6_GII.P7","MF140676_NLD_human_2013_GII.6_GII.P7")
)
groupOTU(p, grp, 'Species') + aes(color=Species) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
grp <- list(same = c("KM198549_VNM_human_2010_GII.6_GII.P7","KM198531_VNM_human_2009_GII.6_GII.P7"),
same = c("MF140680_NLD_human_2014_GII.6_GII.P7","MF140679_NLD_human_2014_GII.6_GII.P7","MF140676_NLD_human_2013_GII.6_GII.P7"),
same = c("JX459907_AUS_human_2012_GII.4_GII.P31","AB972499_JPN_human_2011_GII.4_GII.P31")
)
groupOTU(p, grp, 'Species') + aes(color=Species) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
grp <- list(#same = c("KM198549_VNM_human_2010_GII.6_GII.P7","KM198531_VNM_human_2009_GII.6_GII.P7"),
same = c("MF140680_NLD_human_2014_GII.6_GII.P7","MF140679_NLD_human_2014_GII.6_GII.P7","MF140676_NLD_human_2013_GII.6_GII.P7"),
same = c("JX459907_AUS_human_2012_GII.4_GII.P31","AB972499_JPN_human_2011_GII.4_GII.P31")
)
groupOTU(p, grp, 'Species') + aes(color=Species) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
lines = readLines("trees.txt")
View(tree1)
lines
gregexpr("[A-Za-z0-9_./]",lines[0])
lines[0]
lines[1]
gregexpr("[A-Za-z0-9_./]",lines[1])
matches = gregexpr("[A-Za-z0-9_./]",lines[1])
regmatches(lines[1], matches)
matches = gregexpr("[A-Za-z0-9_./]+",lines[1])
regmatches(lines[1], matches)
matches = gregexpr("[:alnum:_./]+",lines[1])
regmatches(lines[1], matches)
matches = regexpr("[A-Za-z0-9_./]+",lines[1])
regmatches(lines[1], matches)
regmatches(lines[1], gregexpr("[A-Za-z0-9_./]+",lines[1]))
regmatches(lines[1], gregexpr("[A-Za-z0-9_./]+",lines[1]))[[1]]
name_match = regmatches(lines[1], gregexpr("[A-Za-z0-9_./]+",lines[1]))[[1]]
matches = gregexpr("kaka",lines[1])
View(matches)
matches != [[-1]]
matches != list(-1)
matches
matches$math.length
matches[[1]]
matches[[1]]["match.length"]
length(mathes)
length(matches)
length(matches[[1]])
matches[[1]]
matches[[1]][1]
find_taxa = function(stri){
matches = gregexpr("[A-Za-z0-9_./]+",stri)
if (matches[[-1]][1] != -1 ){
return(regmatches(stri, gregexpr("[A-Za-z0-9_./]+",stri)[[1]]))
}
else{
return(c())
}
}
capply(lines[1:3],find_taxa)
sapply(lines[1:3],find_taxa)
find_taxa = function(stri){
matches = gregexpr("[A-Za-z0-9_./]+",stri)
if (matches[[1]][1] != -1 ){
return(regmatches(stri, gregexpr("[A-Za-z0-9_./]+",stri)[[1]]))
}
else{
return(c())
}
}
sapply(lines[1:3],find_taxa)
find_taxa = function(stri){
matches = gregexpr("[A-Za-z0-9_./]+",stri)
if (matches[[1]][1] != -1 ){
return(regmatches(stri, matches)[[1]])
}
else{
return(c())
}
}
sapply(lines[1:3],find_taxa)
names = sapply(lines[1:3],find_taxa)
names = lapply(lines[1:3],find_taxa)
View(names)
names
groupOTU(p, names, 'Species') + aes(color=Species) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
names_taxa = lapply(lines[1:3],find_taxa)
length(names_taxa)
names(names_taxa) <- rep("same", length(names_taxa))
groupOTU(p, names_taxa, 'Species') + aes(color=Species) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
source(get_subtrees.R)
source("get_subtrees.R")
setwd("D:/Virology/RNA_viruses/Compare_trees")
subtrees = get_subtrees("trees.txt")
source("get_subtrees.R")
subtrees = get_subtrees("trees.txt")
lines = readLines("trees.txt")
p <- ggtree(tree1, layout = 'rectangular', branch.length='none')
groupOTU(p, names_taxa, 'Species') + aes(color=Species) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
p <- ggtree(tree1,mrsd="2025-01-01")
groupOTU(p, names_taxa, 'Species') + aes(color=Species) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
library(ggtree)
library(treeio) #read.beast
library(ape) # for phylo objects
library(tidyr)
source("get_subtrees.R")
setwd("D:/Virology/RNA_viruses/Compare_trees")
subtrees = get_subtrees("trees.txt")
subtrees
subtrees = get_subtrees("trees.txt")
subtrees = get_subtrees("trees.txt")
source("get_subtrees.R")
setwd("D:/Virology/RNA_viruses/Compare_trees")
subtrees = get_subtrees("trees.txt")
tree1_name = "D:/Virology/RNA_viruses/Picornaviruses/virus-recombination/Trees/P2/Asia1.treefile"
tree1_name = "D:/Virology/RNA_viruses/Picornaviruses/virus-recombination/Trees/MCC/Asia1_P1.tree"
tree1 = read.beast(tree1_name)
p <- ggtree(tree1,mrsd="2025-01-01")
groupOTU(p, names_taxa, 'Species') + aes(color=Species) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
subtrees
groupOTU(p, subtrees, 'Species') + aes(color=Species) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
p <- ggtree(tree1,mrsd="2025-01-01")
groupOTU(p, subtrees, 'Species') + aes(color=Species) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
groupOTU(p, subtrees, 'Clade') + aes(color=Species) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
View(subtrees)
groupOTU(p, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
subtrees = get_subtrees("trees.txt")
groupOTU(p, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
library(ggtree)
library(treeio) #read.beast
library(ape) # for phylo objects
library(tidyr)
library(ggpubr)
source("get_subtrees.R")
subtrees = get_subtree("Asia1_Asia1_P1_biparts.txt")
subtrees = get_subtrees("Asia1_Asia1_P1_biparts.txt")
tree1_name = "D:/Virology/RNA_viruses/Picornaviruses/virus-recombination/Trees/MCC/Asia1_P1.tree"
#tree1_name = "norovirus_rdrp_g2_yearonly_colnodes.tree"
tree1 = read.beast(tree1_name)
p <- ggtree(tree1,mrsd="2025-01-01") + geom_tiplab() + theme_tree2() + geom_label2(aes(label=round(as.numeric(posterior),2)),size=2)
p
g1 = groupOTU(p, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
g1
g1
p <- ggtree(tree1,mrsd="2025-01-01") + geom_tiplab(size=2) + theme_tree2() + geom_label2(aes(label=round(as.numeric(posterior),2)),size=2)
p
g1 = groupOTU(p, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
g1
subtrees = get_subtrees("Asia1_Asia1_Coord_4981_6100_biparts.txt")
p <- ggtree(tree1,mrsd="2025-01-01") + geom_tiplab(size=2) + theme_tree2() + geom_label2(aes(label=round(as.numeric(posterior),2)),size=2)
p
g1 = groupOTU(p, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
g1
subtrees = get_subtrees("Asia1_Asia1_Coord_4981_6100_biparts.txt")
p <- ggtree(tree1,mrsd="2025-01-01") + geom_tiplab(size=2) + theme_tree2() + geom_label2(aes(label=round(as.numeric(posterior),2)),size=2)
p
g1 = groupOTU(p, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
g1
subtrees = get_subtrees("Asia1_P1_Asia1_commontrees.txt")
subtrees = get_subtrees("Asia1_Asia1_P1_biparts.txt")
tree1_name = "D:/Virology/RNA_viruses/Picornaviruses/virus-recombination/Trees/MCC/Asia1_P1.tree"
tree2_name = "Asia1.treefile"
#tree1_name = "norovirus_rdrp_g2_yearonly_colnodes.tree"
tree1 = read.beast(tree1_name)
tree2 = read.tree(tree2_name)
p1 <- ggtree(tree1,mrsd="2025-01-01") + geom_tiplab(size=2) + theme_tree2() + geom_label2(aes(label=round(as.numeric(posterior),2)),size=2)
p
g1 = groupOTU(p1, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
g1
p2 <- ggtree(tree2) + geom_tiplab(size=2) + theme_tree2() + geom_label2(aes(label=as.numeric(label)),size=2)
g2 = groupOTU(p2, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
final = ggarrange(g1,g2)
final
subtrees = get_subtrees("Asia1_Asia1_P1_biparts.txt")
p1 <- ggtree(tree1,mrsd="2025-01-01") + geom_tiplab(size=2) + theme_tree2() + geom_label2(aes(label=round(as.numeric(posterior),2)),size=2)
p
g1 = groupOTU(p1, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
p2 <- ggtree(tree2) + geom_tiplab(size=2) + theme_tree2() + geom_label2(aes(label=as.numeric(label)),size=2)
g2 = groupOTU(p2, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
final = ggarrange(g1,g2)
final
subtrees = get_subtrees("Asia1_Asia1_P1_biparts.txt")
p1 <- ggtree(tree1,mrsd="2025-01-01") + geom_tiplab(size=2) + theme_tree2() + geom_label2(aes(label=round(as.numeric(posterior),2)),size=2)
g1 = groupOTU(p1, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
p2 <- ggtree(tree2) + geom_tiplab(size=2) + theme_tree2() + geom_label2(aes(label=as.numeric(label)),size=2)
g2 = groupOTU(p2, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
final = ggarrange(g1,g2)
final
subtrees = get_subtrees("Asia1_Asia1_P1_biparts.txt")
p1 <- ggtree(tree1,mrsd="2025-01-01") + geom_tiplab(size=2) + theme_tree2() + geom_label2(aes(label=round(as.numeric(posterior),2)),size=2)
g1 = groupOTU(p1, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
p2 <- ggtree(tree2) + geom_tiplab(size=2) + theme_tree2() + geom_label2(aes(label=as.numeric(label)),size=2)
g2 = groupOTU(p2, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
final = ggarrange(g1,g2)
final
subtrees = get_subtrees("Asia1_Asia1_Coord_4981_6100_biparts.txt")
tree3_name = "Asia1_Coord_4981_6100.treefile"
tree2 = read.tree(tree3_name)
subtrees = get_subtrees("Asia1_Asia1_Coord_4981_6100_biparts.txt")
p1 <- ggtree(tree1,mrsd="2025-01-01") + geom_tiplab(size=2) + theme_tree2() + geom_label2(aes(label=round(as.numeric(posterior),2)),size=2)
g1 = groupOTU(p, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
tree3_name = "Asia1_Coord_4981_6100.treefile"
tree3 = read.tree(tree3_name)
subtrees = get_subtrees("Asia1_Asia1_Coord_4981_6100_biparts.txt")
p1 <- ggtree(tree1,mrsd="2025-01-01") + geom_tiplab(size=2) + theme_tree2() + geom_label2(aes(label=round(as.numeric(posterior),2)),size=2)
g1 = groupOTU(p, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
p3 <- ggtree(tree3) + geom_tiplab() + theme_tree2() + geom_label2(aes(label=as.numeric(label)),size=2)
g3 = groupOTU(p3, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
final = ggarrange(g1,g3)
final
p1 <- ggtree(tree1,mrsd="2025-01-01") + geom_tiplab(size=2) + theme_tree2() + geom_label2(aes(label=round(as.numeric(posterior),2)),size=2)
g1 = groupOTU(p, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
p3 <- ggtree(tree3) + geom_tiplab(size=2) + theme_tree2() + geom_label2(aes(label=as.numeric(label)),size=2)
g3 = groupOTU(p3, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
final = ggarrange(g1,g3)
final
library(ggtree)
library(treeio) #read.beast
library(ape) # for phylo objects
library(tidyr)
library(ggpubr)
source("get_subtrees.R")
subtrees = get_subtrees("norovirus_rdrp_g2_yearonly_colnodes_norovirus_vp1_g2_yearonly345_commontrees_bip.txt")
tree1_name = "norovirus_rdrp_g2_yearonly_colnodes.tree"
tree1 = read.beast(tree1_name)
p1 <- ggtree(tree1,mrsd="2025-01-01") + geom_tiplab(size=2) + theme_tree2() + geom_label2(aes(label=round(as.numeric(posterior),2)),size=2)
g1 = groupOTU(p1, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
View(subtrees)
subtrees = get_subtrees("norovirus_rdrp_g2_yearonly_colnodes_norovirus_vp1_g2_yearonly345_commontrees_bip.txt")
subtrees[["same"]]
source("get_subtrees.R")
subtrees = get_subtrees("norovirus_rdrp_g2_yearonly_colnodes_norovirus_vp1_g2_yearonly345_commontrees_bip.txt")
p1 <- ggtree(tree1,mrsd="2025-01-01") + geom_tiplab(size=2) + theme_tree2() + geom_label2(aes(label=round(as.numeric(posterior),2)),size=2)
g1 = groupOTU(p1, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
g1
tree1_name = "norovirus_vp1_g2_yearonly345.tree"
tree1 = read.beast(tree1_name)
p1 <- ggtree(tree1,mrsd="2025-01-01") + geom_tiplab(size=2) + theme_tree2() + geom_label2(aes(label=round(as.numeric(posterior),2)),size=2)
g1 = groupOTU(p1, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
g1
subtrees = get_subtrees("norovirus_rdrp_g2_yearonly_colnodes_norovirus_vp1_g2_yearonly345_commontrees_bip.txt")
p1 <- ggtree(tree1,mrsd="2025-01-01") + geom_tiplab(size=2) + theme_tree2() + geom_label2(aes(label=round(as.numeric(posterior),2)),size=2)
g1 = groupOTU(p1, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
g1
tree3_name = "Asia1_Coord_4981_6100.treefile"
tree3 = read.tree(tree3_name)
tree1_name = "D:/Virology/RNA_viruses/Picornaviruses/virus-recombination/Trees/MCC/Asia1_P1.tree"
subtrees = get_subtrees("Asia1_Asia1_Coord_4981_6100_biparts.txt")
p1 <- ggtree(tree1,mrsd="2025-01-01") + geom_tiplab(size=2) + theme_tree2() + geom_label2(aes(label=round(as.numeric(posterior),2)),size=2)
g1 = groupOTU(p, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
p3 <- ggtree(tree3) + geom_tiplab(size=2) + theme_tree2() + geom_label2(aes(label=as.numeric(label)),size=2)
g3 = groupOTU(p3, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
final = ggarrange(g1,g3)
final
p1 <- ggtree(tree1,mrsd="2025-01-01") + geom_tiplab(size=2) + theme_tree2() + geom_label2(aes(label=round(as.numeric(posterior),2)),size=2)
g1 = groupOTU(p1, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
p3 <- ggtree(tree3) + geom_tiplab(size=2) + theme_tree2() + geom_label2(aes(label=as.numeric(label)),size=2)
g3 = groupOTU(p3, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
final = ggarrange(g1,g3)
final
subtrees = get_subtrees("Asia1_Asia1_Coord_4981_6100_biparts.txt")
p1 <- ggtree(tree1,mrsd="2025-01-01") + geom_tiplab(size=2) + theme_tree2() + geom_label2(aes(label=round(as.numeric(posterior),2)),size=2)
p1
tree1 = read.beast(tree1_name)
tree1_name = "D:/Virology/RNA_viruses/Picornaviruses/virus-recombination/Trees/MCC/Asia1_P1.tree"
tree1 = read.beast(tree1_name)
p1 <- ggtree(tree1,mrsd="2025-01-01") + geom_tiplab(size=2) + theme_tree2() + geom_label2(aes(label=round(as.numeric(posterior),2)),size=2)
g1 = groupOTU(p1, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
p3 <- ggtree(tree3) + geom_tiplab(size=2) + theme_tree2() + geom_label2(aes(label=as.numeric(label)),size=2)
g3 = groupOTU(p3, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
final = ggarrange(g1,g3)
final
subtrees = get_subtrees("Asia1_Asia1_Coord_4981_6100_biparts.txt")
p1 <- ggtree(tree1,mrsd="2025-01-01") + geom_tiplab(size=2) + theme_tree2() + geom_label2(aes(label=round(as.numeric(posterior),2)),size=2)
subtrees = get_subtrees("Asia1_Asia1_Coord_4981_6100_biparts.txt")
p1 <- ggtree(tree1,mrsd="2025-01-01") + geom_tiplab(size=2) + theme_tree2() + geom_label2(aes(label=round(as.numeric(posterior),2)),size=2)
g1 = groupOTU(p1, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
p3 <- ggtree(tree3) + geom_tiplab(size=2) + theme_tree2() + geom_label2(aes(label=as.numeric(label)),size=2)
g3 = groupOTU(p3, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
final = ggarrange(g1,g3)
final
final
tree1_name = "D:/Virology/RNA_viruses/Picornaviruses/virus-recombination/Trees/MCC/Asia1_P1.tree"
tree2_name = "Asia1.treefile"
tree1 = read.beast(tree1_name)
tree2 = read.tree(tree2_name)
p1 <- ggtree(tree1,mrsd="2025-01-01") + geom_tiplab(size=2) + theme_tree2() + geom_label2(aes(label=round(as.numeric(posterior),2)),size=2)
g1 = groupOTU(p1, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
g1
# Path to file with tree in nexus format produced by BEAST
tree1_name = "norovirus_vp1.tree"
tree1 = read.beast(tree1_name)
tree2_name = "norovirus_rdrp_g2.tree"
tree2 = read.beast(tree2_name)
setwd("D:/Scripts/compare_trees_RF")
# set  working directory
#setwd("")
# Load functions from source code
source("get_subtrees.R")
subtrees = get_subtrees("norovirus_vp1_norovirus_rdrp_g2_commontrees.txt")
# Path to file with tree in nexus format produced by BEAST
tree1_name = "norovirus_vp1.tree"
tree1 = read.beast(tree1_name)
tree2_name = "norovirus_rdrp_g2.tree"
tree2 = read.beast(tree2_name)
# Plot beast subtree and color braches of common subtrees
p1 = ggtree(tree1,mrsd="2025-01-01") +  geom_tiplab(size=2) + geom_label2(aes(label=round(as.numeric(posterior),2)),size=2)
p1 = groupOTU(p1, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
p2 = ggtree(tree2,mrsd="2025-01-01") +  geom_tiplab(size=2) + geom_label2(aes(label=round(as.numeric(posterior),2)),size=2)
p2 = groupOTU(p2, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
ggarrange(p1,p2)
# Path to file with tree in nexus format produced by BEAST
tree1_name = "Asia1.treefile"
tree1 = read.beast(tree1_name)
tree2_name = "Asia1_Coord_4981_6100.treefile"
tree1_name = "D:/Virology/RNA_viruses/Picornaviruses/virus-recombination/Trees/MCC/Asia1_P1.tree"
tree1 = read.beast(tree1_name)
# Path to file with tree in nexus format produced by BEAST
tree1_name = "Asia1_P1.tree"
tree1 = read.beast(tree1_name)
tree2_name = "Asia1_Coord_4981_6100.treefile"
tree2 = read.tree(tree2_name)
# common subtrees determined from coinciding bipartitions in two trees
subtrees = get_subtrees("Asia1_P1_Asia1_Coord_4981_6100_commontrees_bip.txt")
# Plot beast subtree and color braches of common subtrees
p1 = ggtree(tree1,mrsd="2025-01-01") +  geom_tiplab(size=2) + geom_label2(aes(label=round(as.numeric(posterior),2)),size=2)
p1 = groupOTU(p1, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
# Plot beast subtree and color braches of common subtrees
p1 = ggtree(tree1,mrsd="2025-01-01") +  geom_tiplab(size=2) +
geom_label2(aes(label=round(as.numeric(posterior),2)),size=2) +
theme_tree2()
p1 = groupOTU(p1, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
p2 = ggtree(tree2) +  geom_tiplab(size=2) +
geom_label2(aes(label=round(as.numeric(label),2)),size=2) +
theme_tree2()
p2 = groupOTU(p2, subtrees, 'Clade') + aes(color=Clade) +
theme(legend.position="right") + scale_color_manual(values=c("black", "firebrick"))
ggarrange(p1,p2)
